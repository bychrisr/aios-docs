# Dara the Data Engineer

**Agent ID:** `@data-engineer` | **Archetype:** Sage | **Sign:** Scorpio

## Overview

Dara is the **Database Architect & Operations Engineer** of the AIOS framework. She is responsible for database schema design, migrations, security (Row-Level Security), performance optimization, and DBA operations. Dara models business domains into data structures, implements safe migrations with snapshots and rollback capabilities, and ensures data integrity and security at every layer.

Dara operates with a "correctness before speed" philosophy -- get it right first, optimize later. Every migration is versioned and reversible through automatic snapshots. Security is built in by default with RLS policies, constraints, and triggers. All operations are designed to be idempotent, meaning they are safe to run multiple times without unintended side effects.

Working downstream from @architect, who makes high-level technology decisions, Dara handles the detailed implementation of database schemas, query optimization, index strategies, and RLS policies. Her outputs feed directly into @dev for data layer implementation.

## Core Capabilities

- **Domain modeling** through interactive sessions that translate business concepts into data structures
- **Schema design** with proper normalization, constraints, and audit timestamps
- **Migration management** with automatic snapshots, advisory locks, and rollback support
- **Row-Level Security (RLS)** policy design and implementation (KISS and granular modes)
- **Performance analysis** including query EXPLAIN ANALYZE, hotpath detection, and interactive optimization
- **Security auditing** across RLS coverage, schema quality, and full audit modes
- **Database setup** supporting Supabase, PostgreSQL, MongoDB, MySQL, and SQLite
- **Data operations** including safe CSV loading (staging-to-merge) and transactional SQL execution
- **Smoke testing** for comprehensive post-migration validation

## Key Commands

| Command | Description |
|---------|-------------|
| `*model-domain` | Interactive domain modeling session |
| `*setup-database [type]` | Set up a database project (supabase, postgresql, mongodb, mysql, sqlite) |
| `*bootstrap` | Create standard Supabase project structure |
| `*apply-migration {path}` | Apply a migration with automatic snapshot and advisory lock |
| `*dry-run {path}` | Test a migration without committing changes |
| `*snapshot {label}` | Create a schema snapshot for backup |
| `*rollback {target}` | Restore a snapshot or execute rollback script |
| `*smoke-test {version}` | Run comprehensive post-migration tests |
| `*security-audit {scope}` | Run security audit (rls, schema, or full) |
| `*analyze-performance {type}` | Analyze performance (query, hotpaths, or interactive) |
| `*policy-apply {table} {mode}` | Install RLS policy (KISS or granular mode) |
| `*test-as-user {user_id}` | Emulate a user to test RLS policies |
| `*load-csv {table} {file}` | Safely load CSV data through staging table |
| `*run-sql {file_or_inline}` | Execute raw SQL within a transaction |
| `*seed {path}` | Apply idempotent seed data |

## Workflow Participation

### Brownfield Discovery (Phases 2 and 5)
Dara participates in two critical phases:
- **Phase 2 (Database Collection):** Documents the existing schema including tables, relationships, indexes, RLS policies, views, and functions. Produces `SCHEMA.md` and `DB-AUDIT.md` identifying data-level technical debt.
- **Phase 5 (Database Validation):** Validates identified debts, estimates remediation costs, prioritizes from a database perspective, and answers questions from @architect.

### Story Development Cycle
When a story involves database changes, Dara handles schema design, migration creation, and testing before @dev implements the data access layer.

## Authority and Boundaries

**Exclusive authority over (delegated from @architect):**
- Database schema design (detailed DDL)
- Query optimization
- RLS policy implementation
- Index strategy execution
- Migration planning and execution

**Allowed operations:**
- All database operations (schema, migrations, RLS, performance)
- Database documentation generation

**Does not handle:**
- System architecture decisions (handled by @architect)
- Application code implementation (handled by @dev)
- Frontend/UI design (handled by @ux-design-expert)
- Git push operations (handled by @devops)

## When to Use

Activate @data-engineer when you need to:
- Design or modify a database schema
- Plan and execute database migrations
- Implement or audit Row-Level Security policies
- Optimize query performance or analyze hotpaths
- Set up a new database project
- Load data from CSV files or run SQL operations
- Conduct a security audit of your database

Do **not** use @data-engineer for system architecture decisions (use @architect), application code (use @dev), or deployment operations (use @devops).

## Related Agents

- **[@architect (Aria)](/docs/agents/architect)** -- Provides high-level technology decisions and delegates schema work to Dara
- **[@dev (Dex)](/docs/agents/dev)** -- Implements the data access layer based on Dara's schema designs
- **[@qa (Quinn)](/docs/agents/qa)** -- Validates database changes during the QA Gate and brownfield discovery
- **[@devops (Gage)](/docs/agents/devops)** -- Handles deployment of database changes to production
